<!DOCTYPE html>
<html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Khi chỉ còn cái PC | Sang Nguyen | Blog</title>
        <meta name="description" content="Khi chỉ còn cái PC">
<meta name="keywords" content="Javascipt, jQuery, html, css, my stories">
<meta name="author" content="Tasy Nguyen">
        <link rel="shortcut icon" type="image/png" href="/public/img/css/tasynguyen.png"/>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="/assets/css/blog_style.css">
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/styles/default.min.css">
        <link rel="alternate" type="application/rss+xml" title="Tasy Nguyen Blog" href="rss.xml">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    </head>
    <body>
        <div class="navbar-fixed home-bg">            <div class="navbar-content">
                <!-- <div class="navbar-button">
                    <span id="nav-info-toggle">
                        <span class="fa fa-code" ></span> 
                        <span class="toggle-content">Tasy Nguyen</span>
                    </span>
                </div>
                <div class="navbar-button-close" id="nav-info-mobile-close">
                    <span class="fa fa-arrow-left"></span>
                </div> -->
                <div class="navbar-short-info" id="nav-info">
                    <div class="navbar-short-info-avatar">
                        <img src="https://avatars3.githubusercontent.com/u/18634365?s=400&v=4" alt="">
                    </div>
                    <h3>Nguyen Thai Sang</h3>
                    <h4>Web developer</h4>
                    <p>Hello world!</p>
                    <div class="navbar-shor-info-contact">
                        <a class="twitter" target="_blank" href="https://twitter.com/tasyit"><span class="fa fa-twitter"></span></a>
                        <a class="linkedin" target="_blank" href="https://linkedin.com/in/thaisangnguyen3894/"><span class="fa fa-linkedin"></span></a>
                        <a class="github" target="_blank" href="https://github.com/tasynguyen3894/"><span class="fa fa-github"></span></a>
                    </div>
                </div>
                <div class="navbar-quotes" id="navbar-quotes">
                    <div class="navbar-quotes-content">
    The power of intuitive understanding will protect you from harm until the end of your days.
</div>
<div class="navbar-quotes-speaker">
    Laozi
</div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="container-content">
                <!-- <div class="navbar-button">
                    <span class="fa fa-arrow-right" id="nav-info-mobile-open"></span>

                </div> -->
                <div class="navbar-menu">
                    <div class="title-mobile">
                        <a href="index.html">Tasy Nguyen Blog</a>
                        <span id="toggle-button-mb" class="fa fa-bars"></span>
                    </div>
                    <ul id="menu-mobile">
                        <li><a href="/blog">Blog</a></li>
                        <li><a href="/">Sangnguyen.dev</a></li>
                    </ul>
                </div>
                <div class="main-content">
                    <h1>Xử lý xuất file excel một cách hay ho</h1>
<div class="home-content">
<div class="blog-detail">
<div class="blog-detail-date">Đăng lúc 09/08/2018</div>
<div class="tags">
    <span><a href="tags.html?tag=my-stories">my stories</a></span>
</div>
<p>Hôm nay mình sẽ nói về một trò hay ho mà mình sử dụng khi làm việc với file excel khi còn làm việc trong một công ty "sản xuất".</p>
<p>Công ty "sản xuất" là cách mình gọi các công ty mà họ không thiên về sản phẩm IT như là các nhà xưởng, kho vận... Vai trò của phòng IT chủ yếu là phát triển Enterprise resource planning (ERP) cho nội bộ. Chủ yếu là tính lương, phép, quản lý tài nguyên công ty, lưu trữ các thông tin sổ sách phục vụ các phòng ban khác. Mình từng có thời gian làm việc cho một số công ty như thế với quy mô cũng kha khá với gần mười ngàn nhân viên. Các lập trình viên thường sẽ làm việc trực tiếp với các bộ phận như kế toán, nhân sự, thu mua... Do tính chất công việc và để tiện lợi cho các phòng ban bạn làm việc nên IT thường có yêu cầu là xuất file excel. Thường thì nội dung sẽ liên quan đến ngày công, lương, số lượng hàng hóa được trích xuất từ hệ thống. Đôi lúc các file này có độ phức tạp khá cao đồng thời phải query lượng dữ liệu kha khá. Điều đó gây khá nhiều khó khăn cho thanh niên coder gà như mình. Khó khăn đầu tiên là... chậm.</p>
<p>Do khối lượng dữ liệu phải truy vấn vào cơ sở dữ liệu kha nhiều và phức tạp nên gây ra những câu truy vấn có độ nặng như sao quả tạ. Đồng thời kèm theo đó là sau khi truy vấn xong phải qua một lớp truy vấn và tính toán bằng PHP và ghi lên file excel làm cho tốc độ request lâu kinh khủng khiếp. Cứ thế là phòng nhân sự đủ hét toáng lên rồi. À có thể sẽ có bạn hỏi sao không dùng background job... nhưng xin thú nhận là vào thời điểm đó mình chẳng biết gì về nó cả và cả team IT cũng thế. Đồng thời ngoài lâu thì cũng kéo theo một vấn đề là việc debug và kiểm tra cực kì khó khăn. Các bạn có thể tưởng tượng việc gần mười ngàn nhân viên muôn màu, muôn vẻ thì việc có đôi ba trường hợp sai là điều hết sức bình thường. Nhưng cái sự "bình thường" đó lại làm mình cùng các bạn ở phòng nhân sự hoặc kế toán hết sức đau đầu vì không biết có sót trường hợp lỗi nào hay không, và lỗi ở dòng và cột nào. Đồng thời lỗi đó xuất phát từ đâu cũng trở nên khó đoán hơn vì quá nhiều cột và các công thức tương đối phức tạp. Nhưng lúc đó thì mình chỉ tập trung vào việc cải thiện hiệu năng cũng như sửa lỗi mà không để ý đến các yếu tố khác làm cho kết quả công việc lúc đó hết sức "què quặc". Bẵng đi hơn một năm, tôi lại trôi về một công ty sản xuất khác và nhận một yêu cầu tương tự về tính công và lương của nhân viên. Để tránh những việc khó khăn như từng gặp lần này mình đã thiết kế cơ sở dữ liệu tốt hơn cũng như viết code backend xử lý rõ ràng hơn. Nhưng tình hình vẫn không cải thiện được nhiều ở khoảng kiểm tra cho phòng nhân sự cũng như là hiệu năng. Giữa lúc đó mình nghĩ ra một cách là thay vì tính </p>
<div class="blog-detail-comments">
    <!-- <div id="show-comment-box">
        Comment
    </div> -->
    <div id="post-comment">
        <div id="disqus_thread"></div>
        <script>
        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://https-tasynguyen3894-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</div>
<div class="blog-break-line"></div>
</div>
</div>
                </div>
                <footer>
                    <div>Created with <a href="https://github.com/tasynguyen3894/1989stack">1989Stack</a>
                        | <a href="tags.html"><span class="fa fa-tag"></span></a>
                        <a href="https://twitter.com/tasyit"><span class="fa fa-twitter"></span></a>
                        <a href="https://github.com/tasynguyen3894"><span class="fa fa-github"></span></a>
                    </div>
                    <div><a href="/">sangnguyen.dev</a> - <a href="versions.html">Verison 1.2.0</a> &copy 2018</div>
                </footer>
            </div>
        </div>
        <script src="/public/js/main.js"></script>
        <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
            </body>
</html>